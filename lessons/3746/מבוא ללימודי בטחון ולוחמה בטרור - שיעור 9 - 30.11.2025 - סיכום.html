<html lang="he" dir="rtl"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>×©×™×¢×•×¨ 10 - ×”×ª×§×•×××•×ª ×•×”×ª××•×“×“×•×ª ××™×ª×”</title>
    
    <!-- Meta Tags -->
    <meta name="lesson-title" content="×©×™×¢×•×¨ 10 - ×”×ª×§×•×××•×ª ×•×”×ª××•×“×“×•×ª ××™×ª×”">
    <meta name="lesson-date" content="2025-12-02">
    <meta name="lesson-teacher" content="×’×‘' ×œ×•×¨× ×” ××˜×™××¡-×œ×‘×•×‘×¡×§×™">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Hebrew:wght@300;400;500;700;900&amp;display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <style>
        /* CSS from Master Template - Unchanged */
        :root {
            --bg: #f0f2f5; --surface: #ffffff; --text-main: #1c1e21; --text-sec: #606770;
            --primary: #1877f2; --accent: #e7f3ff; --border: #dadde1; --shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            --w: 800px; --nav-height: 60px;
            --hl-yellow-bg: #fff9c4; --hl-yellow-br: #fdd835;
            --hl-blue-bg: #e3f2fd; --hl-blue-br: #2196f3;
            --hl-green-bg: #e8f5e9; --hl-green-br: #4caf50; 
            --hl-red-bg: #ffebee; --hl-red-br: #ef5350;
            --hl-orange-bg: #fff3e0; --hl-orange-br: #ff9800;
        }
        body.dark-mode {
            --bg: #000000; --surface: #121212; --text-main: #e0e0e0; --text-sec: #b0b3b8;
            --primary: #4a90e2; --accent: #1f2a36; --border: #333333;
            --hl-yellow-bg: #3e3b20; --hl-blue-bg: #1a2836; --hl-green-bg: #1a2e1b; --hl-red-bg: #381e1e;
            --hl-orange-bg: #3e2723;
        }
        * { box-sizing: border-box; font-family: 'Noto Sans Hebrew', sans-serif !important; }
        .fas, .far, .fab, .fa { font-family: "Font Awesome 6 Free" !important; }
        body { background-color: var(--bg); color: var(--text-main); margin: 0; line-height: 1.6; font-size: 14px; padding-bottom: var(--nav-height); display: block; }

        /* Header */
        header { background: var(--surface); border-bottom: 1px solid var(--border); position: sticky; top: 0; z-index: 1000; padding: 0.6rem 0; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .header-content { max-width: var(--w); margin: 0 auto; padding: 0 20px; display: flex; justify-content: space-between; align-items: center; position: relative;}
        .header-content h1 { font-size: 1.1rem; margin: 0; display:flex; align-items:center; gap:10px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 50vw; }
        
        .search-container { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: var(--surface); align-items: center; padding: 0 10px; z-index: 10; }
        .search-container.active { display: flex; }
        .search-input { flex-grow: 1; border: none; background: var(--bg); padding: 8px 12px; border-radius: 20px; color: var(--text-main); outline: none; font-size: 16px; margin-right: 10px; }
        .search-close { background: none; border: none; cursor: pointer; color: var(--text-sec); font-size: 1.2rem; }
        .found-mark { background-color: #ffeb3b; color: black; border-radius: 2px; box-shadow: 0 0 5px yellow; animation: pulseMark 1s infinite alternate; }
        @keyframes pulseMark { from { background-color: #ffeb3b; } to { background-color: #ffcc00; } }

        .btn-action { background: var(--accent); border: none; border-radius: 50%; width: 34px; height: 34px; color: var(--primary); cursor: pointer; transition: 0.2s; display: inline-flex; align-items: center; justify-content: center; margin-left: 5px; font-size: 14px; flex-shrink: 0; }
        .btn-action.active { background: var(--primary); color: white; }
        .btn-save-file { background: #4caf50; color: white; } 

        /* Tabs */
        .main-wrap { max-width: var(--w); margin: 20px auto; padding: 0 20px 80px; }
        .tabs { display: flex; flex-wrap: wrap; justify-content: center; gap: 5px; border-bottom: 2px solid var(--border); margin-bottom: 20px; padding-bottom: 5px;}
        .tab-link { background: none; border: none; padding: 8px 12px; font-size: 0.95rem; font-weight: 500; color: var(--text-sec); cursor: pointer; border-bottom: 3px solid transparent; transition: 0.3s; margin-bottom: -7px; }
        .tab-link.active { color: var(--primary); border-bottom-color: var(--primary); }
        .bottom-nav { display: none; position: fixed; bottom: 0; left: 0; width: 100%; height: var(--nav-height); background: var(--surface); border-top: 1px solid var(--border); z-index: 9000; justify-content: space-around; align-items: center; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); }
        .nav-item { display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--text-sec); font-size: 10px; background: none; border: none; width: 20%; padding: 5px 0; cursor: pointer;}
        .nav-item.active { color: var(--primary); }
        .tab-content { display: none; animation: fadeIn 0.3s; }
        .tab-content.active { display: block; }

        /* Content */
        .card { background: var(--surface); border-radius: 12px; box-shadow: var(--shadow); padding: 20px; margin-bottom: 20px; position: relative; min-height: 80px; }
        .highlight { padding: 6px 12px 10px; margin: 10px 0; border-radius: 6px; border-right: 4px solid transparent; position: relative; font-size: 0.92em !important; }
        .highlight > *:first-child { margin-top: 0; }
        .highlight h4 { margin: 0 0 4px 0; font-weight: 700; font-size: 1.1em; }
        .hl-example { background-color: var(--hl-yellow-bg); border-color: var(--hl-yellow-br); }
        .hl-external { background-color: var(--hl-blue-bg); border-color: var(--hl-blue-br); }
        .hl-success { background-color: var(--hl-green-bg); border-color: var(--hl-green-br); } 
        .hl-fail { background-color: var(--hl-red-bg); border-color: var(--hl-red-br); }
        .hl-context { background-color: var(--hl-orange-bg); border-color: var(--hl-orange-br); }

        h3 { border-bottom: 1px solid var(--border); padding-bottom: 8px; margin-bottom: 15px; font-size: 1.2rem; color: var(--text-main); }
        p, li { margin-bottom: 10px; line-height: 1.7; }

        .meta-row { display: flex; justify-content: flex-start; align-items: center; border-bottom: 1px dashed var(--border); padding: 10px 0; width: 100%; }
        .meta-label { font-weight: 700; color: var(--text-sec); margin-left: 15px; min-width: 60px; }
        .meta-value { font-weight: 400; color: var(--text-main); flex-grow: 1; text-align: right; outline: none; border-bottom: 1px solid transparent; min-height: 24px; }
        .meta-value:focus { border-bottom: 1px solid var(--primary); background: rgba(24,119,242,0.05); }
        input[type="date"] { border: none; background: transparent; color: var(--text-main); width: auto; flex-grow: 1; text-align: right; outline: none; }
        ol.glossary-list { padding-right: 25px; margin: 0; list-style: none; counter-reset: gloss-counter; }
        ol.glossary-list li { position: relative; margin-bottom: 12px; padding-right: 5px; }
        ol.glossary-list li::before { content: counter(gloss-counter) "."; counter-increment: gloss-counter; position: absolute; right: -20px; color: var(--primary); font-weight: 800; }
        .term { color: var(--primary) !important; font-weight: 700; cursor: help; border-bottom: 1px dotted var(--primary); position: relative; display: inline-block; }
        .term:hover { background-color: var(--accent); }
        .term:hover::after { content: attr(data-def); position: absolute; bottom: 125%; left: 50%; transform: translateX(-50%); background: #333; color: #fff; padding: 10px; border-radius: 8px; width: max-content; max-width: 260px; font-size: 13px; z-index: 99999; white-space: normal; text-align: center; box-shadow: 0 5px 20px rgba(0,0,0,0.3); pointer-events: none; }
        .term:hover::before { content:''; position:absolute; bottom:115%; left:50%; margin-left:-6px; border-width:6px; border-style:solid; border-color:#333 transparent transparent transparent; z-index:99999; }
        details { border: 1px solid var(--border); border-radius: 8px; margin-bottom: 10px; overflow: visible; background: var(--surface); position: relative; }
        summary { padding: 15px; cursor: pointer; font-weight: 700; font-size: 1.1rem; display: flex; justify-content: space-between; background: var(--surface); position: sticky; top: 64px; z-index: 90; border-bottom: 1px solid transparent; transition: 0.2s; border-radius: 8px; }
        details[open] summary { border-bottom: 1px solid var(--border); border-bottom-left-radius: 0; border-bottom-right-radius: 0; }
        .acc-body { padding: 15px; border-top: none; min-height: 50px; font-size: 14px; }

        .edit-wrapper { position: relative; margin-bottom: 8px; width: 100%; }
        body.editing-mode .edit-wrapper { border: 1px dashed rgba(0,0,0,0.15); padding-top: 40px; border-radius: 6px; background: rgba(255,255,255,0.3); }
        .wrapper-toolbar { display: none; position: absolute; top: 5px; right: 5px; gap: 5px; z-index: 100; direction: ltr; }
        body.editing-mode .wrapper-toolbar { display: flex; }
        .w-btn { width: 30px; height: 30px; background: #fff; border: 1px solid var(--border); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; color: #555; font-size: 13px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: 0.2s; }
        .w-btn:hover { transform: scale(1.1); background: var(--primary); color: white; border-color: var(--primary); }
        .w-btn.del:hover { background: #ef5350; border-color: #ef5350; }
        .w-btn.term { color: var(--primary); font-weight:bold; border-color: var(--accent); }
        .editable-content[contenteditable="true"] { outline: none; cursor: text; min-height: 1.2em; }
        
        .fab-btn { position: fixed; bottom: 25px; left: 25px; width: 60px; height: 60px; background: var(--primary); color: white; border-radius: 50%; box-shadow: 0 4px 15px rgba(0,0,0,0.3); border: none; cursor: pointer; font-size: 26px; z-index: 2000; transition: transform 0.2s; display: flex; align-items: center; justify-content: center; }
        .fab-btn:hover { transform: scale(1.1); }
        
        .editor-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 3000; justify-content: center; align-items: center; }
        .editor-box { background: var(--surface); padding: 25px; border-radius: 12px; width: 90%; height: 85%; max-width: 900px; box-shadow: 0 10px 40px rgba(0,0,0,0.4); display: flex; flex-direction: column; cursor: default; pointer-events: auto; }
        .type-scroll { display: flex; gap: 10px; overflow-x: auto; padding: 10px; margin-bottom: 5px; flex-wrap: wrap; justify-content: center; }
        .type-btn { padding: 8px 16px; border: 1px solid var(--border); border-radius: 4px; cursor: pointer; font-size: 0.95rem; font-weight: 500; display: flex; align-items: center; gap: 6px; background: var(--surface); color: var(--text-main); transition: 0.2s; }
        .type-btn.selected { box-shadow: 0 0 0 2px var(--primary); font-weight: 700; transform: translateY(-2px); }
        .btn-text.selected { background: #eee; border-color: #999; }
        .btn-acc.selected { background: #333; color: #fff; border-color: #000; }
        .btn-ext { background: var(--hl-blue-bg); border-color: var(--hl-blue-br); color: #005c69; }
        .btn-ex { background: var(--hl-yellow-bg); border-color: var(--hl-yellow-br); color: #5f4c00; }
        .btn-per { background: var(--hl-green-bg); border-color: var(--hl-green-br); color: #1b5e20; }
        .btn-task { background: var(--hl-red-bg); border-color: var(--hl-red-br); color: #b71c1c; }
        .btn-ctx { background: var(--hl-orange-bg); border-color: var(--hl-orange-br); color: #e65100; }
        #editorTitleInput { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid var(--border); border-radius: 6px; font-weight: bold; background: var(--bg); color: var(--text-main); }
        .editor-toolbar { display: flex; gap: 8px; margin-bottom: 5px; background: #f9f9f9; padding: 8px; border-radius: 6px; flex-wrap: wrap; align-items: center; }
        .tb-btn { padding: 5px 10px; background: #fff; border: 1px solid #ccc; border-radius: 4px; cursor: pointer; }
        .palette-row { display: flex; gap: 4px; flex-wrap: wrap; }
        .color-swatch { width: 20px; height: 20px; border-radius: 4px; cursor: pointer; border: 1px solid #ccc; }
        .rich-editor { flex: 1; border: 1px solid var(--border); border-radius: 6px; padding: 15px; overflow-y: auto; background: var(--bg); font-size: 16px; color: var(--text-main); outline: none; cursor: text; }
        .modal-actions { margin-top: 15px; display: flex; justify-content: space-between; }
        .btn-save { background: var(--primary); color: white; border: none; padding: 10px 24px; border-radius: 6px; cursor: pointer; font-size: 1rem;}
        .btn-cancel { background: transparent; color: var(--text-sec); border: 1px solid var(--border); padding: 10px 24px; border-radius: 6px; cursor: pointer; font-size: 1rem;}
        
        body.placing-mode { cursor: crosshair; }
        body.placing-mode .card, body.placing-mode .acc-body, body.placing-mode .content-zone { outline: 2px dashed var(--primary); min-height: 80px; }
        body.placing-mode *:hover { box-shadow: inset 0 0 0 1000px rgba(24,119,242,0.1); z-index: 3000; }
        @media (max-width: 768px) { .tabs { display: none; } .bottom-nav { display: flex !important; } .fab-btn { bottom: 75px; } .header-content h1 { font-size: 0.9rem; } }
        @media print { header, .tabs, .fab-btn, .editor-overlay, .wrapper-toolbar { display: none !important; } body { display: block !important; font-size: 12px; } body.editing-mode { border: none !important; padding: 0 !important; } }
    </style>
</head>
<body class="">

    <header>
        <div class="header-content">
            <div class="search-container" id="searchContainer">
                <input type="text" class="search-input" id="pageSearch" placeholder="×—×™×¤×•×© ×—×›×..." onkeypress="handleSmartSearch(event)">
                <button class="search-close" onclick="toggleSearch()">âœ–</button>
            </div>
            <div class="brand">
                <h1><i class="fas fa-graduation-cap"></i> <span id="header-title-text">×©×™×¢×•×¨ 10 - ×”×ª×§×•×××•×ª ×•×”×ª××•×“×“×•×ª ××™×ª×”</span></h1>
            </div>
            <div class="actions">
                <button class="btn-action" onclick="toggleSearch()" title="×—×™×¤×•×©"><i class="fas fa-search"></i></button>
                <button class="btn-action" onclick="window.close()" title="×¡×’×•×¨"><i class="fas fa-arrow-right"></i></button>
                <button class="btn-action btn-save-file" onclick="downloadSource()" title="×©××•×¨ ×§×•×‘×¥ HTML"><i class="fas fa-save"></i></button>
                <button class="btn-action" id="editToggleBtn" onclick="toggleEditMode()" title="××¦×‘ ×¢×¨×™×›×”"><i class="fas fa-pen"></i></button>
                <button class="btn-action" id="theme-toggle" title="×™×•×/×œ×™×œ×”"><i class="fas fa-moon"></i></button>
                <button class="btn-action" onclick="window.print()" title="×”×“×¤×¡/PDF"><i class="fas fa-print"></i></button>
            </div>
        </div>
    </header>

    <div class="main-wrap">
        <nav class="tabs">
            <button class="tab-link active" onclick="switchTab('overview', this)">×¡×§×™×¨×”</button>
            <button class="tab-link" onclick="switchTab('content', this)">×ª×•×›×Ÿ</button>
            <button class="tab-link" onclick="switchTab('qa', this)">×©××œ×•×ª</button>
            <button class="tab-link" onclick="switchTab('glossary', this)">××•× ×—×™× ×•××§×•×¨×•×ª</button>
            <button class="tab-link" onclick="switchTab('tasks', this)">××˜×œ×•×ª</button>
        </nav>

        <div id="overview" class="tab-content active">
            <div class="card" id="meta-card">
                <h3>×¤×¨×˜×™ ×”×©×™×¢×•×¨</h3>
                <div class="meta-row"><span class="meta-label">× ×•×©×:</span><span id="meta-subject" class="meta-value" contenteditable="false">×©×™×¢×•×¨ 10 - ×”×ª×§×•×××•×ª ×•×”×ª××•×“×“×•×ª ××™×ª×”</span></div>
                <div class="meta-row"><span class="meta-label">××¨×¦×”:</span><span id="meta-value-teacher" class="meta-value" contenteditable="false">×’×‘' ×œ×•×¨× ×” ××˜×™××¡-×œ×‘×•×‘×¡×§×™</span></div>
                <div class="meta-row"><span class="meta-label">×ª××¨×™×š:</span><input type="date" id="meta-value-date" class="meta-value" value="2025-12-02" disabled="true"></div>
            </div>
            <div class="card"><h3>×ª×§×¦×™×¨</h3><div id="summary-text" class="content-zone">
                <div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><p>×©×™×¢×•×¨ ×–×” ×¢×•×¡×§ ×‘××•×¤×Ÿ ××¢××™×§ ×‘×ª×•×¤×¢×ª ×”<strong>×”×ª×§×•×××•×ª (Insurgency)</strong> ×•×‘× ×’×–×¨×•×ª×™×”: ×˜×¨×•×¨, ×’×¨×™×œ×” ×•×œ×•×—××” ×‘×¢×¦×™××•×ª × ××•×›×” (LIC). ×”×©×™×¢×•×¨ × ×¤×ª×— ×‘××™×¤×•×™ ×”×©×™× ×•×™ ×”×”×™×¡×˜×•×¨×™ ×‘×©×“×” ×”×§×¨×‘ (××”×’×¨×¢×™×Ÿ ×œ×§×•× ×‘× ×¦×™×•× ×œ×™ ×•××©× ×œ×—×ª×¨× ×•×ª), ×•×‘×•×—×Ÿ ××ª ×”××•×“×œ ×”××¨×›×–×™ ×©×œ <strong>×“×•×“ ×’×œ×•×œ×”</strong> ("×©×ª×™ ××œ×—××•×ª ×‘××œ×—××” ××—×ª"). ×‘×”××©×š, ×× ×• ××‘×—×™× ×™× ×‘×™×Ÿ ×¡×•×’×™ ×¡×›×¡×•×›×™× ×©×•× ×™× (×”×¤×™×›×”, ××”×¤×›×”, ××¨×™ ××–×¨×—×™), ×•×× ×ª×—×™× ××ª ×”×-×¡×™××˜×¨×™×” ×”×›×œ×›×œ×™×ª ×•×”×¦×‘××™×ª ×‘×™×Ÿ ×”××“×™× ×” ×œ××•×¨×“×™×. ×“×’×© ××™×•×—×“ × ×™×ª×Ÿ ×œ"××›× ×™×–×" ×©×‘×• ×”×ª×§×•×××•×ª ××¦×œ×™×—×”: ×›×™×¦×“ ×¤×¢×•×œ×” ×˜×§×˜×™×ª ××œ×™××” ××ª×¨×’××ª ×œ×”×™×©×’ ×¤×•×œ×™×˜×™ ××¡×˜×¨×˜×’×™ ×‘×××¦×¢×•×ª ×× ×™×¤×•×œ×¦×™×” ×©×œ ×”××•×›×œ×•×¡×™×™×” ("×”×œ×‘×‘×•×ª ×•×”××•×—×•×ª"). ×œ×¡×™×•×, ××•×¦×’×ª ×“×•×§×˜×¨×™× ×ª ×”-COIN ×”×××¨×™×§××™×ª ×›××¡×˜×¨×˜×’×™×™×ª ×”××¢× ×” ×”××“×™× ×ª×™×ª.</p></div></div>
            </div></div>
        </div>

        <div id="content" class="tab-content content-zone">
            
            <!-- × ×•×©× 1: ×¨×§×¢ ×•×”×’×“×¨×•×ª -->
            <div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><details open="">
                <summary>ğŸŒ ×”×¨×§×¢: ××¡×•×’×™ ×œ×•×—××” ×œ"×“×•×“ ×’×œ×•×œ×”"</summary>
                <div class="acc-body">
                    <h3>×œ×•×—××” ×§×•× ×‘× ×¦×™×•× ×œ×™×ª ××•×œ ×œ×•×—××” ×‘×—×ª×¨× ×•×ª</h3>
                    <p>×›×“×™ ×œ×”×‘×™×Ÿ ××”×™ ×”×ª×§×•×××•×ª, ×™×© ×œ×”×‘×™×Ÿ ×ª×—×™×œ×” ××”×™ <strong>×œ×</strong>. × ×§×•×“×ª ×”×™×™×—×•×¡ ×©×œ× ×• ×”×™× <span class="term" data-def="××œ×—××” ×‘×™×Ÿ ×©× ×™ ×¦×‘××•×ª ×¡×“×™×¨×™× ××• ×™×•×ª×¨, ×‘×©×“×” ×§×¨×‘ ××•×’×“×¨, ×œ×œ× × ×©×§ ×œ×”×©××“×” ×”××•× ×™×ª.">×œ×•×—××” ×§×•× ×‘× ×¦×™×•× ×œ×™×ª</span>.</p>
                    <div class="highlight hl-context">
                        <h4>×”×©×•×•××”: ×§×•× ×‘× ×¦×™×•× ×œ×™ ××•×œ ×”×ª×§×•×××•×ª</h4>
                        <table border="1" cellpadding="10" cellspacing="0" style="width:100%; border-collapse:collapse;">
                            <tbody><tr>
                                <th>×××¤×™×™×Ÿ</th>
                                <th>×œ×•×—××” ×§×•× ×‘× ×¦×™×•× ×œ×™×ª</th>
                                <th>×”×ª×§×•×××•×ª (Insurgency)</th>
                            </tr>
                            <tr>
                                <td><strong>×”×¦×“×“×™×</strong></td>
                                <td>××“×™× ×” ××•×œ ××“×™× ×” (×¦×‘× ××•×œ ×¦×‘×)</td>
                                <td>××“×™× ×” ××•×œ ×©×—×§×Ÿ ×œ×-××“×™× ×ª×™</td>
                            </tr>
                            <tr>
                                <td><strong>×©×“×” ×”×§×¨×‘</strong></td>
                                <td>×—×–×™×ª ××•×’×“×¨×ª ×•×‘×¨×•×¨×”</td>
                                <td>×‘×ª×•×š ×”××•×›×œ×•×¡×™×™×” ×”××–×¨×—×™×ª</td>
                            </tr>
                            <tr>
                                <td><strong>×”×™×’×™×•×Ÿ ×”× ×™×¦×—×•×Ÿ</strong></td>
                                <td>×”×©××“×ª ×›×•×— ×”××•×™×‘ / ×›×™×‘×•×© ×©×˜×—</td>
                                <td>×‘×™×“×•×“ ×”××•×¨×“×™× ××”××•×›×œ×•×¡×™×™×” ("×”×“×’ ××”××™×")</td>
                            </tr>
                            <tr>
                                <td><strong>×“×•×’××”</strong></td>
                                <td>××œ×—××ª ×”×¢×•×œ× ×”×©× ×™×™×”, ×¨×•×¡×™×”-××•×§×¨××™× ×”</td>
                                <td>×•×™×™×˜× ××, ××œ×’'×™×¨×™×”, ×¢×™×¨××§ (××—×¨×™ 2003)</td>
                            </tr>
                        </tbody></table>
                    </div>

                    <h3>×“×•×“ ×’×œ×•×œ×” ×•×”-COIN</h3>
                    <div class="highlight hl-external">
                        <h4>×“×•×“ ×’×œ×•×œ×” (1919â€“1967)</h4>
                        <div class="editable-content" contenteditable="false">
                            <p>×§×¦×™×Ÿ ×¦×¨×¤×ª×™-×™×”×•×“×™ ×™×œ×™×“ ×ª×•× ×™×¡×™×”. × ×—×©×‘ ×œ××‘×™ ×ª×•×¨×ª ×”-<strong>Counter-Insurgency (COIN)</strong>. ×œ×—× ×‘××œ×’'×™×¨×™×” ×•×‘×¡×™×Ÿ, ×•×”×‘×™×Ÿ ×©×”×›×•×— ×”×¦×‘××™ ×œ×‘×“×• ×œ× ×™×›×•×œ ×œ× ×¦×— ×”×ª×§×•×××•×ª. ×ª×•×¨×ª×• ××•××¦×” ×‘-2006 ×¢×œ ×™×“×™ ×”×’× ×¨×œ ×“×™×•×•×™×“ ×¤×˜×¨××•×¡ ×‘×¦×‘× ××¨×”"×‘ (FM 3-24).</p>
                        </div>
                    </div>
                    <p>×’×œ×•×œ×” ×˜×¢×Ÿ ×©×‘×›×œ ×”×ª×§×•×××•×ª ×™×© ×©×ª×™ ××œ×—××•×ª: ×”××œ×—××” ×”×¦×‘××™×ª ×•×”××œ×—××” ×”×¤×•×œ×™×˜×™×ª. ×”× ×™×¦×—×•×Ÿ ×”×¦×‘××™ ×”×•× ×—×¡×¨ ××©××¢×•×ª ×œ×œ× × ×™×¦×—×•×Ÿ ×¤×•×œ×™×˜×™ (×¨×›×™×©×ª ×××•×Ÿ ×”××•×›×œ×•×¡×™×™×”).</p>
                </div>
            </details></div></div>

            <!-- × ×•×©× 2: ×˜×™×¤×•×œ×•×’×™×” ×©×œ ×¡×›×¡×•×›×™× ×¤× ×™××™×™× -->
            <div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><details open="">
                <summary>ğŸ”„ ×”×‘×—× ×” ××•×©×’×™×ª: ×”×ª×§×•×××•×ª, ×”×¤×™×›×” ×•××”×¤×›×”</summary>
                <div class="acc-body">
                    <p>×›×“×™ ×œ×”×‘×™×Ÿ ××ª ×”×–×™×¨×”, ×¢×œ×™× ×• ×œ×“×™×™×§ ×‘××•× ×—×™×:</p>
                    <table border="1" cellpadding="10" cellspacing="0" style="width:100%; border-collapse:collapse; margin-bottom:15px;">
                        <tbody><tr style="background-color: var(--accent);">
                            <th>×¡×•×’ ×”×¡×›×¡×•×š</th>
                            <th>××§×•×¨ ×”×›×•×— ("×›×™×•×•×Ÿ")</th>
                            <th>××©×š ×”×–××Ÿ</th>
                            <th>×××¤×™×™× ×™×</th>
                        </tr>
                        <tr>
                            <td><strong>×”×ª×§×•×××•×ª (Insurgency)</strong></td>
                            <td>××œ××˜×” ×œ××¢×œ×” (Bottom-up)</td>
                            <td>×××•×©×š (Protracted)</td>
                            <td>×××‘×§ ×××•×¨×’×Ÿ, ××©×œ×‘ ×¤×¢×™×œ×•×ª ×¦×‘××™×ª ×•×¤×•×œ×™×˜×™×ª. ×“×•×¨×© ×’×™×•×¡ ××©××‘×™× ××™×˜×™.</td>
                        </tr>
                        <tr>
                            <td><strong>×”×¤×™×›×” (Coup d'Ã©tat)</strong></td>
                            <td>××œ××¢×œ×” ×œ××˜×” (Top-down)</td>
                            <td>×§×¦×¨ ×•××”×™×¨</td>
                            <td>××‘×•×¦×¢×ª ×¢×œ ×™×“×™ ××œ×™×˜×•×ª (×œ×¨×•×‘ ×¦×‘×) ××ª×•×š ×”××¢×¨×›×ª (×§×•× ×¡×¤×™×¨×¦×™×”). ××‘×•×¡×¡×ª ×¢×œ ×¡×•×“×™×•×ª ×•×”×©×ª×œ×˜×•×ª ×¢×œ ××•×§×“×™ ×›×•×— (×ª×§×©×•×¨×ª, ×¤×¨×œ×× ×˜).</td>
                        </tr>
                        <tr>
                            <td><strong>××”×¤×›×” (Revolution)</strong></td>
                            <td>×¢×××™ (Grassroots)</td>
                            <td>××©×ª× ×”</td>
                            <td>×”×ª×¤×¨×¦×•×ª ×¨×—×‘×” ×©×œ ×”×”××•× ×™×. ××˜×¨×ª×” ×©×™× ×•×™ ××§×™×£ ×©×œ ×”×¡×“×¨ ×”×—×‘×¨×ª×™-×¤×•×œ×™×˜×™ (×œ× ×‘×”×›×¨×— ×‘××œ×™××•×ª).</td>
                        </tr>
                    </tbody></table>

                    <div class="highlight hl-example">
                        <h4>×“×•×’××” ××”×›×™×ª×”: ×”××”×¤×›×” ×‘×ª×•× ×™×¡×™×” (×”××‘×™×‘ ×”×¢×¨×‘×™)</h4>
                        <div class="editable-content" contenteditable="false">
                            <p>×”××—××” ×”×—×œ×” ×××¢×©×” ×™×—×™×“ ×©×œ ××•×›×¨ ×”×™×¨×§×•×ª ××•×—××“ ×‘×•×¢×–×™×–×™ (×©×”×¦×™×ª ××ª ×¢×¦××•), ×•×”×ª×¤×©×˜×” ×‘××”×™×¨×•×ª ×œ<strong>××”×¤×›×” ×¢×××™×ª</strong> ×¨×—×‘×”. ×–×” ×©×•× ×” ××”×•×ª×™×ª ×<strong>×”×¤×™×›×” ×¦×‘××™×ª</strong> (×›××• ×‘××¦×¨×™× ×¢× ×-×¡×™×¡×™) ××• ×<strong>×”×ª×§×•×××•×ª</strong> ×××•×¨×’× ×ª ×•×××•×©×›×ª ×©×œ ××¨×’×•×Ÿ ×’×¨×™×œ×”.</p>
                        </div>
                    </div>

                    <h3>×××¤×™×™× ×™× ××¨×›×–×™×™× ×©×œ ××¨×™×“×” (Insurgency)</h3>
                    <ul>
                        <li><strong>××˜×¨×” ×¤×•×œ×™×˜×™×ª:</strong> ×”×—×œ×¤×ª ×”××©×˜×¨ ××• ×”×—×œ×©×ª ×”×œ×’×™×˜×™××™×•×ª ×©×œ×•.</li>
                        <li><strong>×œ×•×—××” ××¡×™××˜×¨×™×ª:</strong> ×”×›×•×— ×”××•×¨×“ ×—×œ×© ×™×•×ª×¨ ×¦×‘××™×ª ××”××“×™× ×”.</li>
                        <li><strong>×”×¡×ª××›×•×ª ×¢×œ ×”××•×›×œ×•×¡×™×™×”:</strong> ×§×‘×œ×ª ××—×¡×”, ××•×“×™×¢×™×Ÿ ×•×œ×•×’×™×¡×˜×™×§×” ××”××§×•××™×™×.</li>
                        <li><strong>×××‘×§ ×××•×©×š:</strong> ×©×—×™×§×ª ×”×¨×¦×•×Ÿ ×”×¤×•×œ×™×˜×™ ×©×œ ×”×™×¨×™×‘ ×œ××•×¨×š ×–××Ÿ (×œ× ×”×›×¨×¢×” ×‘"×–×‘× ×’ ×•×’××¨× ×•").</li>
                    </ul>
                </div>
            </details></div></div>

            <!-- × ×•×©× 3: ×”××›× ×™×–× ×•×”××¡×˜×¨×˜×’×™×” -->
            <div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><details open="">
                <summary>ğŸ”„ ×”××›× ×™×–×: ×›×™×¦×“ ×”×ª×§×•×××•×ª ××©×™×’×” ××ª ××˜×¨×ª×”?</summary>
                <div class="acc-body">
                    <p>×›×™×¦×“ ××¨×’×•×Ÿ ×§×˜×Ÿ ×•×—×œ×© ××¦×œ×™×— ×œ×¢×¨×¢×¨ ××“×™× ×” ×—×–×§×”? ×”×ª×©×•×‘×” ×˜××•× ×” ×‘××¢×’×œ ×§×¡××™× ×”××—×‘×¨ ×‘×™×Ÿ ×¤×¢×•×œ×” ××œ×™××” (×˜×§×˜×™×ª) ×œ×”×™×©×’ ××“×™× ×™ (××¡×˜×¨×˜×’×™). ×”××•×“×œ ×©×œ × ×•×™××Ÿ ×•×¡××™×ª' ××¡×‘×™×¨ ×–××ª:</p>

                    <div class="highlight hl-context">
                        <h4>××¢×’×œ ×”×”×ª×§×•×××•×ª (The Insurgency Cycle)</h4>
                        <div class="editable-content" contenteditable="false">
                            <ol>
                                <li><strong>×¤×¨×•×‘×•×§×¦×™×” (Disorientation):</strong> ×”××¨×’×•×Ÿ ××‘×¦×¢ ×¤×™×’×•×¢ ×˜×¨×•×¨ ××–×¢×–×¢ ×•×¡××œ×™ (×œ××©×œ: 11/9, ×”×¤×™×’×•×¢ ×‘××œ×•×Ÿ ×”××œ×š ×“×•×“). ×”××˜×¨×”: ×œ×–×¨×•×¢ ×›××•×¡, ×¤×—×“ ×•×—×•×¡×¨ ×‘×™×˜×—×•×Ÿ.</li>
                                <li><strong>×ª×’×•×‘×ª ×”××“×™× ×” (Target Response):</strong> ×”××“×™× ×”, ××ª×•×š ×œ×—×¥, ××’×™×‘×”. ×›××Ÿ ×”××œ×›×•×“×ª:
                                    <ul>
                                        <li><strong>×ª×’×•×‘×ª ×™×ª×¨ (Overreaction):</strong> ×”×¤×¢×œ×ª ×›×•×— ×¦×‘××™ ××¡×™×‘×™ ×©×¤×•×’×¢ ×‘×—×¤×™× ××¤×©×¢ --&gt; ×”××¨×’×•×Ÿ ××¦×™×’ ××ª ×”××“×™× ×” ×›"×¤×•×©×¢×ª" ×•×›×›×•×— ×–×¨/×›×•×‘×©.</li>
                                        <li><strong>×ª×ª-×ª×’×•×‘×” (Underreaction):</strong> ×—×•×¡×¨ ××¢×© --&gt; ×”××¨×’×•×Ÿ ××¦×™×’ ××ª ×”××“×™× ×” ×›×—×œ×©×” ×•×œ× ××¡×•×’×œ×ª ×œ×”×’×Ÿ ×¢×œ ××–×¨×—×™×”.</li>
                                    </ul>
                                </li>
                                <li><strong>×“×”-×œ×’×™×˜×™××¦×™×” ×œ××“×™× ×”:</strong> ×‘×¢×§×‘×•×ª ×”×ª×’×•×‘×” (××• ×”×™×¢×“×¨×”), ×”×¦×™×‘×•×¨ ×××‘×“ ×××•×Ÿ ×‘×××©×œ×”.</li>
                                <li><strong>×œ×’×™×˜×™××¦×™×” ×œ××•×¨×“×™×:</strong> ×”××¨×’×•×Ÿ × ×›× ×¡ ×œ×•××§×•× ×•××¦×™×’ ××ª ×¢×¦××• ×›××’×Ÿ ×”×¢× ×•×›××œ×˜×¨× ×˜×™×‘×” ×©×œ×˜×•× ×™×ª.</li>
                            </ol>
                        </div>
                    </div>

                    <h3>××¡×˜×¨×˜×’×™×•×ª ×”×©×’×ª ×™×¢×“×™×</h3>
                    <p>×”×”×ª×§×•×××•×ª ×¤×•×¢×œ×ª ×‘×©× ×™ ××™×©×•×¨×™× ×‘××§×‘×™×œ ×›×“×™ ×œ×”×©×™×’ ××ª ××˜×¨×•×ª×™×”:</p>
                    
                    <h4>1. ××™×©×•×¨ ×”×œ×•×—××” (×¦×‘××™/×§×™× ×˜×™)</h4>
                    <ul>
                        <li><strong>×˜×¨×•×¨:</strong> ×™×¦×™×¨×ª ×¤×—×“, ×¤×’×™×¢×” ×‘××–×¨×—×™× ("××˜×¨×•×ª ×¨×›×•×ª").</li>
                        <li><strong>×’×¨×™×œ×”:</strong> ×”×ª×©×ª ×”×¦×‘×, ×¤×’×™×¢×” ×‘×—×™×™×œ×™× ("××˜×¨×•×ª ×§×©×•×ª"), ×¤×’×¢ ×•×‘×¨×—.</li>
                    </ul>

                    <h4>2. ××™×©×•×¨ ×”×¤×•×œ×™×˜×™×§×” (××–×¨×—×™/×—×‘×¨×ª×™)</h4>
                    <ul>
                        <li><strong>×”×¤×¦×ª ××™×“×¢ (×¤×¨×•×¤×’× ×“×”):</strong> ×©×œ×™×˜×” ×‘× ×¨×˜×™×‘.</li>
                        <li><strong>×”×¤×’× ×•×ª ×•×’×™×•×¡ ×”××•× ×™×:</strong> ×™×¦×™×¨×ª ×œ×—×¥ ×¦×™×‘×•×¨×™.</li>
                        <li><strong>××ª×Ÿ ×©×™×¨×•×ª×™× (Da'wa):</strong> ××™×œ×•×™ ×”×•×•××§×•× ×©×”×•×ª×™×¨×” ×”××“×™× ×” (×‘×¨×™××•×ª, ×—×™× ×•×š, ×¨×•×•×—×”).</li>
                        <li><strong>×’×™×•×¡ ×›×¡×¤×™× ×•×“×™×¤×œ×•××˜×™×”:</strong> ×™×¦×™×¨×ª ×§×©×¨×™× ×‘×™× ×œ××•××™×™× ×•×œ×’×™×˜×™××¦×™×” ×—×™×¦×•× ×™×ª.</li>
                    </ul>

                    <h3>×¢×œ×•×™×•×ª ×-×¡×™××˜×¨×™×•×ª</h3>
                    <p>×”××•×¨×“×™× × ×”× ×™× ××™×ª×¨×•×Ÿ ×›×œ×›×œ×™ ××•×‘×”×§: "×§×œ ×•×–×•×œ ×œ×”×‘×¢×™×¨ ××©".</p>
                    <div class="highlight hl-example">
                        <h4>×“×•×’××” ××”×›×™×ª×”: ×¤×™×’×•×¢×™ ×”-11/9</h4>
                        <div class="editable-content" contenteditable="false">
                            <p>×”×¢×œ×•×ª ×”×™×©×™×¨×” ×œ××œ-×§××¢×™×“×” ×”×™×™×ª×” ×›-500 ××œ×£ ×“×•×œ×¨. ×”×¢×œ×•×ª ×œ××¨×”"×‘ (×‘×™×˜×—×•×Ÿ, ××œ×—××•×ª ×‘××¤×’× ×™×¡×˜×Ÿ ×•×¢×™×¨××§) × ×××“×ª ×‘×˜×¨×™×œ×™×•× ×™×. ×–×”×• × ×™×¦×—×•×Ÿ ××¡×˜×¨×˜×’×™ ×©×œ ×©×—×™×§×ª ××©××‘×™ ×”×™×¨×™×‘.</p>
                        </div>
                    </div>
                </div>
            </details></div></div>

            <!-- × ×•×©× 4: ×”×××‘×§ ×¢×œ ×”××•×›×œ×•×¡×™×™×” -->
            <div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><details open="">
                <summary>ğŸ§  "×”×œ×‘×‘×•×ª ×•×”××•×—×•×ª" ×•××¨×’×•× ×™× ×”×™×‘×¨×™×“×™×™×</summary>
                <div class="acc-body">
                    <p>×”××•×›×œ×•×¡×™×™×” ×”×™× ××¨×›×– ×”×›×•×‘×“. ××™ ×©×©×•×œ×˜ ×‘×” â€“ ×× ×¦×—. ××¨×’×•× ×™ ×”×ª×§×•×××•×ª ××•×“×¨× ×™×™× ×”× <strong>×”×™×‘×¨×™×“×™×™×</strong> (××©×•×œ×‘×™×):</p>
                    <ul>
                        <li><strong>×–×¨×•×¢ ×¦×‘××™×ª:</strong> ××‘×¦×¢×ª ×¤×™×’×•×¢×™× ×•×œ×—×™××ª ×’×¨×™×œ×”.</li>
                        <li><strong>×–×¨×•×¢ ××“×™× ×™×ª/×—×‘×¨×ª×™×ª (Da'wa):</strong> ××¡×¤×§×ª ×©×™×¨×•×ª×™× ×©×”××“×™× ×” × ×›×©×œ×” ×‘×”× (×—×™× ×•×š, ×‘×¨×™××•×ª, ×¨×•×•×—×”).</li>
                    </ul>

                    <div class="highlight hl-example">
                        <h4>××§×¨×” ×‘×•×—×Ÿ: ×—×××¡ ×•×—×™×–×‘××œ×œ×”</h4>
                        <div class="editable-content" contenteditable="false">
                            <p>×—×™×–×‘××œ×œ×” ××¤×¢×™×œ ×‘×ª×™ ×—×•×œ×™× ×‘×—×™× × ×•×¨×©×ª ×—×™× ×•×š ×‘×“×¨×•× ×œ×‘× ×•×Ÿ. ×—×××¡ ××¤×¢×™×œ ×‘×ª×™ ×ª××—×•×™. ×–×” ×™×•×¦×¨ ×ª×œ×•×ª ×©×œ ×”××•×›×œ×•×¡×™×™×” ×‘××¨×’×•×Ÿ. ×›×©×”××™×—×•×“ ×”××™×¨×•×¤×™ ××’×“×™×¨ ×¨×§ ××ª "×”×–×¨×•×¢ ×”×¦×‘××™×ª" ×›××¨×’×•×Ÿ ×˜×¨×•×¨, ×”×•× ××ª×¢×œ× ××›×š ×©×”×–×¨×•×¢ ×”××–×¨×—×™×ª ×”×™× ×©××™×™×¦×¨×ª ××ª ×”×œ×’×™×˜×™××™×•×ª ×œ×˜×¨×•×¨.</p>
                        </div>
                    </div>
                </div>
            </details></div></div>

            <!-- × ×•×©× 5: ×˜×§×˜×™×§×•×ª ×•××¢× ×” (×’×¨×™×œ×” ×•-COIN) -->
            <div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><details open="">
                <summary>âš”ï¸ ×˜×¨×•×¨ vs. ×’×¨×™×œ×” ×•×”××¢× ×” ×”××“×™× ×ª×™ (COIN)</summary>
                <div class="acc-body">
                    <h3>×”×‘×—× ×” ×˜×§×˜×™×ª</h3>
                    <ul>
                        <li><strong>×˜×¨×•×¨:</strong> ×¤×’×™×¢×” ××›×•×•× ×ª ×‘××–×¨×—×™× ("××˜×¨×•×ª ×¨×›×•×ª") ×œ×™×¦×™×¨×ª ×¤×—×“ (××œ×™××•×ª ×—×¨×™×’×” ×•×¡××œ×™×ª).</li>
                        <li><strong>×’×¨×™×œ×”:</strong> ×¤×’×™×¢×” ×‘×›×•×—×•×ª ×¦×‘× ×•××©×˜×¨×” ("××˜×¨×•×ª ×§×©×•×ª") ×‘××˜×¨×” ×œ×©×—×•×§ ××ª ×›×•×— ×”×œ×—×™××” ×©×œ ×”××•×™×‘. ×’×™×©×” ×¦×‘××™×ª ×©×œ ×”×˜×¨×“×”.</li>
                    </ul>
                    <p>×‘×¤×•×¢×œ, ×”×’×‘×•×œ×•×ª ××˜×•×©×˜×©×™×. ×‘-7 ×‘××•×§×˜×•×‘×¨ ×—×××¡ ×”×¤×¢×™×œ ×’× ×’×¨×™×œ×” (×¤×©×™×˜×” ×¢×œ ×‘×¡×™×¡×™×) ×•×’× ×˜×¨×•×¨ (×˜×‘×— ×‘××–×¨×—×™×).</p>

                    <h3>COIN: ×”××¢× ×” ×”×××¨×™×§××™</h3>
                    <p>×“×•×§×˜×¨×™× ×ª ×”-Counter-Insurgency (×›×¤×™ ×©× ×•×¡×—×” ×‘-FM 3-24) ×’×•×¨×¡×ª ×›×™ ××™ ××¤×©×¨ ×œ× ×¦×— ×¨×§ ×‘×›×•×— ××© ("Kill capture"). ×”×©×™×˜×” ×”×™× <strong>Clear, Hold, Build</strong>:</p>
                    <ol>
                        <li><strong>Clear:</strong> ×˜×™×”×•×¨ ×”×©×˜×— ×××•×¨×“×™× (×¦×‘××™).</li>
                        <li><strong>Hold:</strong> ×”×™×©××¨×•×ª ×‘×©×˜×— ×›×“×™ ×œ×”×’×Ÿ ×¢×œ ×”××•×›×œ×•×¡×™×™×” (×©×™×˜×•×¨ ×•×‘×™×˜×—×•×Ÿ).</li>
                        <li><strong>Build:</strong> ×©×™×§×•× ×ª×©×ª×™×•×ª ×•×—×™×–×•×§ ×”×›×œ×›×œ×” ×›×“×™ ×œ×™×™×ª×¨ ××ª ×”×¦×•×¨×š ×‘××•×¨×“×™× (××–×¨×—×™/×›×œ×›×œ×™).</li>
                    </ol>
                </div>
            </details></div></div>

        </div>

        <div id="qa" class="tab-content">
            <div class="card">
                <h3>×©××œ×•×ª ×•×“×™×•×Ÿ</h3>
                <div id="qa-body" class="content-zone">
                    <div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><h5>×©××œ×”: ×”×× ×ª×§×™×¤×ª ××˜×¨×•×ª ×¦×‘××™×•×ª × ×—×©×‘×ª ×˜×¨×•×¨?</h5></div></div>
                    <div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><p><strong>×ª×©×•×‘×”:</strong> ×œ×¤×™ ×”×”×’×“×¨×” ×”××§×“××™×ª ×”×™×‘×©×” (×œ××©×œ ×©×œ ×‘×•×¢×– ×’× ×•×¨), ×ª×§×™×¤×ª ×—×™×™×œ×™× ×”×™× "×’×¨×™×œ×”" ×•×ª×§×™×¤×ª ××–×¨×—×™× ×”×™× "×˜×¨×•×¨". ×¢× ×–××ª, ×›×©××™×¨×’×•×Ÿ ×›××• ×—×××¡ ××‘×¦×¢ ××ª ×©× ×™×”×, ×”×•× ××•×’×“×¨ ×›××¨×’×•×Ÿ ×˜×¨×•×¨ ×”×™×‘×¨×™×“×™.</p></div></div>
                    <div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><hr></div></div>
                    <div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><h5>×©××œ×”: ××™×š ××‘×“×™×œ×™× ×‘×™×Ÿ ××œ×—××ª ××–×¨×—×™× ×œ×”×ª×§×•×××•×ª?</h5></div></div>
                    <div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><p><strong>×ª×©×•×‘×”:</strong> ×œ×¢×™×ª×™× ×§×©×” ×œ×”×‘×“×™×œ. ××œ×—××ª ××–×¨×—×™× ×œ×¨×•×‘ ××¨××–×ª ×¢×œ ×©× ×™ ×¦×“×“×™× ×¢× ×›×•×— ×™×—×¡×™×ª ×©×§×•×œ ×”× ×œ×—××™× ×¢×œ ×”×©×œ×˜×•×Ÿ. ×”×ª×§×•×××•×ª ××“×’×™×©×” ××ª ×”<strong>×-×¡×™××˜×¨×™×”</strong>: ×¦×“ ××—×“ ×”×•× ×”××“×™× ×” ×”××‘×•×¡×¡×ª (×”×—×–×§×”), ×•×”×¦×“ ×”×©× ×™ ×”×•× ×”××¨×’×•×Ÿ ×”××•×¨×“ (×”×—×œ×© ×‘×ª×—×™×œ×”).</p></div></div>
                    <div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><hr></div></div>
                    <div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><h5>×©××œ×”: ×œ××” ××¨×”"×‘ × ×›×©×œ×” ×‘×•×•×™×™×˜× ××/××¤×’× ×™×¡×˜×Ÿ ×× ×”×™×™×ª×” ×œ×” ×“×•×§×˜×¨×™× ×ª COIN?</h5></div></div>
                    <div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><p><strong>×ª×©×•×‘×”:</strong> ×›×™ ×”×™×™×©×•× ×§×©×” ×‘×”×¨×‘×” ××”×ª×™××•×¨×™×”. ×§×©×” ×××•×“ ×œ×‘× ×•×ª ××“×™× ×” ×–×¨×” ("Nation Building") ×›×©××™×Ÿ ×œ×š ×œ×’×™×˜×™××¦×™×” ××§×•××™×ª, ×•×›×©×”××•×›×œ×•×¡×™×™×” ×¨×•××” ×‘×š ×›×•×— ×›×•×‘×© ×–×¨. ×‘× ×•×¡×£, ×”×¤×•×œ×™×˜×™×§×” ×”×¤× ×™××™×ª ×‘××¨×”"×‘ ×œ× ××¤×©×¨×” ××ª ××•×¨×š ×”×¨×•×— (×©× ×™× ×¨×‘×•×ª) ×©× ×“×¨×© ×œ× ×™×¦×—×•×Ÿ ×‘-COIN.</p></div></div>
                </div>
            </div>
        </div>

        <div id="glossary" class="tab-content">
            <div class="card">
                <h3>××•× ×—×™× ×•×”×’×“×¨×•×ª</h3>
                <ol class="glossary-list content-zone" id="glossary-list">
                    <li data-term-id="t1"><div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><strong>Insurgency (×”×ª×§×•×××•×ª):</strong> ×××‘×§ ×¤×•×œ×™×˜×™-×¦×‘××™ ×××•×¨×’×Ÿ ×•×××•×©×š ×©×œ ×§×‘×•×¦×” ×œ×-××“×™× ×ª×™×ª × ×’×“ ××©×˜×¨ ×§×™×™× ××• ×›×•×— ×›×•×‘×©.</div></div></li>
                    <li data-term-id="t2"><div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><strong>COIN (Counter-Insurgency):</strong> ×”××¡×˜×¨×˜×’×™×” ×”××“×™× ×ª×™×ª ×œ×”×ª××•×“×“×•×ª ×¢× ×”×ª×§×•×××•×ª, ×”××©×œ×‘×ª ×›×•×— ×¦×‘××™ ×¢× ××××¦×™× ×œ×©×™×¤×•×¨ ×—×™×™ ×”××•×›×œ×•×¡×™×™×” ("×œ×‘×‘×•×ª ×•××•×—×•×ª").</div></div></li>
                    <li data-term-id="t3"><div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><strong>LIC (×¢×™××•×ª ×‘×¢×¦×™××•×ª × ××•×›×”):</strong> ×¡×¤×§×˜×¨×•× ×©×œ ×¡×›×¡×•×›×™× ××œ×™××™× ×©×”× ×¤×—×•×ª ×××œ×—××” ×›×•×œ×œ×ª (×›××• ×˜×¨×•×¨ ×•×’×¨×™×œ×”).</div></div></li>
                    <li data-term-id="t4"><div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><strong>××œ×—××” ×§×•× ×‘× ×¦×™×•× ×œ×™×ª:</strong> ××œ×—××” ×‘×™×Ÿ ×¦×‘××•×ª ×¡×“×™×¨×™× ×©×œ ××“×™× ×•×ª, ×¢× ×§×•×•×™ ×—×–×™×ª ×‘×¨×•×¨×™× (×‘× ×™×’×•×“ ×œ-LIC).</div></div></li>
                    <li data-term-id="t5"><div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><strong>Coup d'Ã©tat (×”×¤×™×›×”):</strong> ×”×—×œ×¤×ª ×©×œ×˜×•×Ÿ ××”×™×¨×” ×•×›×¤×•×™×” ×¢×œ ×™×“×™ ×’×•×¨××™× ××ª×•×š ×”××¢×¨×›×ª (×œ××©×œ ×”×¦×‘×), ×œ×œ× ×©×™× ×•×™ ×¢×•××§ ×—×‘×¨×ª×™.</div></div></li>
                    <li data-term-id="t6"><div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><strong>××¨×™ ××–×¨×—×™ (Civil Disobedience):</strong> ××¡×˜×¨×˜×’×™×” ×œ×-××œ×™××” ×œ×”×©×’×ª ××˜×¨×•×ª ×¤×•×œ×™×˜×™×•×ª ×‘×××¦×¢×•×ª ×¡×™×¨×•×‘ ×œ×¦×™×™×ª ×œ×—×•×§×™×, ×©×‘×™×ª×•×ª ×•××—××•×ª (×“×•×’××ª ×’× ×“×™).</div></div></li>
                </ol>
            </div>
            <div class="card">
                <h3>××§×•×¨×•×ª ×—×™×¦×•× ×™×™×</h3>
                <ul id="sources-list" class="content-zone">
                    <li><div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><strong>Galula, David (1964).</strong> <em>Counterinsurgency Warfare: Theory and Practice</em>.</div></div></li>
                    <li><div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><strong>Neumann, P. R., &amp; Smith, M. L. R. (2005).</strong> <em>The Strategy of Terrorism</em>.</div></div></li>
                    <li><div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><strong>US Army (2006).</strong> <em>Counterinsurgency Field Manual (FM 3-24)</em>.</div></div></li>
                    <li><div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><strong>Ganor, Boaz.</strong> <em>The Counter-Terrorism Puzzle</em>.</div></div></li>
                </ul>
            </div>
        </div>

        <div id="tasks" class="tab-content">
            <div class="card hl-fail">
                <h3>××˜×œ×•×ª ×œ×©×™×¢×•×¨ ×”×‘×</h3>
                <div id="tasks-body" class="content-zone">
                    <div class="edit-wrapper"><div class="wrapper-toolbar" contenteditable="false"><div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div></div><div class="editable-content" contenteditable="false"><p>×œ×§×¨×•× ××ª ×”××××¨ ×‘× ×•×©× ×”×“×™×œ××” ×”×“××•×§×¨×˜×™×ª ×•×œ× ×ª×—: ××™×œ×• ××’×‘×œ×•×ª ×™×© ×œ×“××•×§×¨×˜×™×” ×‘×××‘×§ ×‘-Insurgency ×©××™×Ÿ ×œ××©×˜×¨ ××•×˜×•×¨×™×˜×¨×™?</p></div></div>
                </div>
            </div>
        </div>
    </div>

    <div class="bottom-nav">
        <button class="nav-item active" onclick="switchTab('overview')"><i class="fas fa-home"></i>×¡×§×™×¨×”</button>
        <button class="nav-item" onclick="switchTab('content')"><i class="fas fa-layer-group"></i>×ª×•×›×Ÿ</button>
        <button class="nav-item" onclick="switchTab('qa')"><i class="fas fa-comments"></i>×©××œ×•×ª</button>
        <button class="nav-item" onclick="switchTab('glossary')"><i class="fas fa-book"></i>××•× ×—×™×</button>
        <button class="nav-item" onclick="switchTab('tasks')"><i class="fas fa-tasks"></i>××˜×œ×•×ª</button>
    </div>

    <button class="fab-btn" onclick="openEditor()"><i class="fas fa-plus"></i></button>

    <div class="editor-overlay" id="editorModal" onclick="closeEditor()">
        <div class="editor-box" onclick="event.stopPropagation()">
            <h3 style="text-align:center;border:none;margin-bottom:10px;">×”×•×¡×¤×ª ×ª×•×›×Ÿ</h3>
            <div class="type-scroll">
                <button class="type-btn btn-text selected" onclick="setType(this, 'text')">×˜×§×¡×˜</button>
                <button class="type-btn btn-acc" onclick="setType(this, 'accordion')"><i class="fas fa-list"></i> × ×•×©×</button>
                <button class="type-btn btn-ext" onclick="setType(this, 'external')"><i class="fas fa-book-open"></i> ×”×¨×—×‘×”</button>
                <button class="type-btn btn-ctx" onclick="setType(this, 'context')"><i class="fas fa-link"></i> ×”×§×©×¨</button>
                <button class="type-btn btn-ex" onclick="setType(this, 'example')"><i class="fas fa-lightbulb"></i> ×“×•×’××”</button>
                <button class="type-btn btn-per" onclick="setType(this, 'personal')"><i class="fas fa-pen-fancy"></i> ×”×¢×¨×”</button>
                <button class="type-btn btn-task" onclick="setType(this, 'task')"><i class="fas fa-tasks"></i> ××˜×œ×”</button>
            </div>
            <input type="text" id="editorTitleInput" placeholder="×›×•×ª×¨×ª..." style="display:none;">

            <div class="editor-toolbar">
                <button class="tb-btn" onmousedown="event.preventDefault(); execCmd('bold')"><b>B</b></button>
                <button class="tb-btn" onmousedown="event.preventDefault(); execCmd('italic')"><i>I</i></button>
                <button class="tb-btn" onmousedown="event.preventDefault(); execCmd('underline')"><u>U</u></button>
                <button class="tb-btn" onmousedown="event.preventDefault(); execCmd('insertOrderedList')"><i class="fas fa-list-ol"></i></button>
                <button class="tb-btn" onmousedown="event.preventDefault(); execCmd('insertUnorderedList')"><i class="fas fa-list-ul"></i></button>
                <div style="width:1px;background:#ccc;margin:0 5px;"></div>
                <div class="palette-row">
                    <div class="color-swatch" style="background:#000000" onmousedown="event.preventDefault(); execCmd('foreColor','#000000')"></div>
                    <div class="color-swatch" style="background:#d32f2f" onmousedown="event.preventDefault(); execCmd('foreColor','#d32f2f')"></div>
                    <div class="color-swatch" style="background:#303f9f" onmousedown="event.preventDefault(); execCmd('foreColor','#303f9f')"></div>
                    <div class="color-swatch" style="background:#388e3c" onmousedown="event.preventDefault(); execCmd('foreColor','#388e3c')"></div>
                    <input type="color" id="cp" onchange="execCmd('foreColor', this.value)" style="visibility:hidden;width:0;">
                </div>
                <div style="width:1px;background:#ccc;margin:0 5px;"></div>
                <button class="tb-btn" onmousedown="event.preventDefault(); createTermFromEditor()" title="×¦×•×¨ ××•× ×—" style="color:var(--primary);"><i class="fas fa-book-open"></i></button>
            </div>
            <div id="richEditor" class="rich-editor" contenteditable="false"></div>
            <div class="modal-actions">
                <button class="btn-cancel" onclick="closeEditor()">×‘×™×˜×•×œ</button>
                <button class="btn-save" onclick="startPlacement()">×‘×—×¨ ××™×§×•×</button>
            </div>
        </div>
    </div>

    <script>
        let isEditMode=false, contentType='text', pendingHTML='', isDirty=false;
        window.onbeforeunload = function() { if (isDirty) return "×©×™× ×•×™×™× ×œ× × ×©××¨×•"; };
        function markDirty() { isDirty = true; }

        window.initMetaData = function() {
            const title = document.querySelector("meta[name='lesson-title']").content;
            const teacher = document.querySelector("meta[name='lesson-teacher']").content;
            const date = document.querySelector("meta[name='lesson-date']").content;
            const subEl = document.getElementById('meta-subject');
            const teachEl = document.getElementById('meta-value-teacher');
            const dateEl = document.getElementById('meta-value-date');
            if(!subEl.innerText) subEl.innerText = title;
            if(!teachEl.innerText) teachEl.innerText = teacher;
            if(!dateEl.value) dateEl.value = date;
            updateHeader();
            subEl.addEventListener('input', () => { markDirty(); updateHeader(); document.querySelector("meta[name='lesson-title']").setAttribute("content", subEl.innerText); });
            teachEl.addEventListener('input', () => { markDirty(); document.querySelector("meta[name='lesson-teacher']").setAttribute("content", teachEl.innerText); });
            dateEl.addEventListener('change', () => { markDirty(); document.querySelector("meta[name='lesson-date']").setAttribute("content", dateEl.value); });
            document.getElementById('glossary-list').addEventListener('input', function(e) {
                markDirty(); const li = e.target.closest('li');
                if(li && li.hasAttribute('data-term-id')) {
                    const tid = li.getAttribute('data-term-id');
                    const parts = li.innerText.split(':');
                    if(parts.length>1) {
                         const newDef = parts.slice(1).join(':').trim();
                         document.querySelectorAll(`.term[data-term-id="${tid}"]`).forEach(t => t.setAttribute('data-def', newDef));
                    }
                }
            });
        };

        function updateHeader() {
            const val = document.getElementById('meta-subject').innerText;
            document.getElementById('header-title-text').innerText = val || '×¡×™×›×•× ×©×™×¢×•×¨';
            document.title = val || '×¡×™×›×•× ×©×™×¢×•×¨';
        }

        function toggleSearch() {
            const el = document.getElementById('searchContainer');
            el.classList.toggle('active');
            if(el.classList.contains('active')) {
                document.getElementById('pageSearch').focus();
                document.querySelectorAll('mark.found-mark').forEach(m => {
                    const p = m.parentNode; parent.replaceChild(document.createTextNode(m.innerText), m); parent.normalize();
                });
            }
        }

        function handleSmartSearch(e) {
            if(e.key !== 'Enter') return;
            const term = document.getElementById('pageSearch').value.trim();
            if(!term) return;
            const walker = document.createTreeWalker(document.querySelector('.main-wrap'), NodeFilter.SHOW_TEXT, null, false);
            let node;
            while(node = walker.nextNode()) {
                if(node.parentElement.tagName === 'SCRIPT' || node.parentElement.tagName === 'STYLE') continue;
                if(node.nodeValue.includes(term)) {
                    let det = node.parentElement.closest('details');
                    while(det) { det.open = true; det = det.parentElement.closest('details'); }
                    const tab = node.parentElement.closest('.tab-content');
                    if(tab) switchTab(tab.id);
                    const range = document.createRange();
                    const index = node.nodeValue.indexOf(term);
                    range.setStart(node, index);
                    range.setEnd(node, index + term.length);
                    const mark = document.createElement('mark');
                    mark.className = 'found-mark';
                    range.surroundContents(mark);
                    mark.scrollIntoView({behavior: 'smooth', block: 'center'});
                    return;
                }
            }
            alert('×œ× × ××¦×: ' + term);
        }

        function switchTab(id, btn) {
            document.querySelectorAll('.tab-content, .tab-link, .nav-item').forEach(e=>e.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            const deskBtn = document.querySelector(`.tab-link[onclick*="'${id}'"]`);
            if(deskBtn) deskBtn.classList.add('active');
            const mobBtn = document.querySelector(`.nav-item[onclick*="'${id}'"]`);
            if(mobBtn) mobBtn.classList.add('active');
        }

        function addTermToTab(text, def, id) {
            const list = document.getElementById('glossary-list');
            const li = document.createElement('li');
            li.setAttribute('data-term-id', id);
            const content = `<strong>${text}:</strong> ${def}`;
            if(isEditMode) li.appendChild(createWrapper(content)); else li.innerHTML = content;
            list.appendChild(li); markDirty();
        }
        window.createTerm = function() {
            const sel = window.getSelection();
            if (!sel.rangeCount || !sel.toString().trim()) return alert('×¡××Ÿ ××™×œ×”');
            const text = sel.toString();
            const def = prompt("×”×’×“×¨×”:"); 
            if (def) { 
                const id='tid_'+Math.floor(Math.random()*10000);
                document.execCommand('insertHTML',false,`<span class="term" data-def="${def}" data-term-id="${id}">${text}</span>`);
                addTermToTab(text,def,id);
            }
        }
        window.createTermFromEditor = function() { window.createTerm(); }

        function openEditor(){ const ed=document.getElementById('richEditor'); ed.innerHTML=''; document.getElementById('editorTitleInput').value=''; document.getElementById('editorModal').style.display='flex'; ed.setAttribute('contenteditable','true'); setTimeout(()=>ed.focus(),100); }
        function closeEditor(){document.getElementById('editorModal').style.display='none';}
        function execCmd(c,v=null){document.execCommand(c,false,v);}

        function setType(btn,type){
            document.querySelectorAll('.type-btn').forEach(b=>b.classList.remove('selected')); btn.classList.add('selected'); contentType=type;
            const tInp=document.getElementById('editorTitleInput'); tInp.style.display=(type!=='text')?'block':'none';
            tInp.placeholder=(type==='accordion')?'×›×•×ª×¨×ª × ×•×©×...':(type==='context')?'×›×•×ª×¨×ª ×”×”×§×©×¨...':'×›×•×ª×¨×ª...';
        }

        function startPlacement(){
            const html=document.getElementById('richEditor').innerHTML; const title=document.getElementById('editorTitleInput').value;
            if(!html&&contentType!=='accordion')return alert('×—×¡×¨ ×ª×•×›×Ÿ');
            let inner='';
            if(contentType==='accordion') inner=`<details open><summary>${title||'× ×•×©×'}</summary><div class="acc-body content-zone">${html}</div></details>`;
            else {
                if(contentType==='text') inner=`<p>${html}</p>`;
                else {
                    let cls='',icon='';
                    if(contentType==='external'){cls='hl-external'; icon='fa-book-open';}
                    else if(contentType==='example'){cls='hl-example'; icon='fa-lightbulb';}
                    else if(contentType==='personal'){cls='hl-success'; icon='fa-pen-fancy';}
                    else if(contentType==='task'){cls='hl-fail'; icon='fa-tasks';}
                    else if(contentType==='context'){cls='hl-context'; icon='fa-link';}
                    inner=`<div class="highlight ${cls}"><h4><i class="fas ${icon}"></i> ${title||(contentType==='context'?'×”×§×©×¨':'×”×¨×—×‘×”')}</h4><div class="editable-content">${html}</div></div>`;
                }
            }
            pendingHTML=inner;
            document.getElementById('editorModal').style.display='none';
            document.body.classList.add('placing-mode');
            const t=document.createElement('div'); t.innerText="×œ×—×¥ ×œ××§×"; t.style.cssText="position:fixed;top:80px;left:50%;transform:translateX(-50%);background:#333;color:#fff;padding:10px;border-radius:20px;z-index:4000;"; document.body.appendChild(t); setTimeout(()=>t.remove(),3000);
            document.addEventListener('click',placeHandler,true);
        }
        function placeHandler(e){
            e.preventDefault();e.stopPropagation(); markDirty();
            let target=e.target.closest('.edit-wrapper,details,li,p,.highlight');
            let container=e.target.closest('.content-zone,.acc-body');
            let node=document.createElement('div'); node.innerHTML=pendingHTML; let newEl=node.firstElementChild;
            if(isEditMode && contentType!=='accordion') newEl=createWrapper(newEl);
            if(target&&target.parentElement.closest('.content-zone,.acc-body')) target.insertAdjacentElement('afterend',newEl);
            else if(container) container.appendChild(newEl);
            else document.getElementById('content').appendChild(newEl);
            document.body.classList.remove('placing-mode');
            document.removeEventListener('click',placeHandler,true);
            if(isEditMode){toggleEditMode();toggleEditMode();}
        }

        function toggleEditMode(){
            isEditMode=!isEditMode; const btn=document.getElementById('editToggleBtn');
            if(isEditMode){
                document.body.classList.add('editing-mode'); btn.classList.add('active');
                document.getElementById('meta-subject').setAttribute('contenteditable','true');
                document.getElementById('meta-value-teacher').setAttribute('contenteditable','true');
                document.getElementById('meta-value-date').removeAttribute('disabled');
                document.querySelectorAll('.content-zone, .acc-body').forEach(z=>wrapDeep(z));
                document.querySelectorAll('.editable-content').forEach(e=>{e.setAttribute('contenteditable','true');e.addEventListener('input',markDirty);});
            } else {
                document.body.classList.remove('editing-mode'); btn.classList.remove('active');
                document.querySelectorAll('[contenteditable]').forEach(e=>e.setAttribute('contenteditable','false'));
                document.getElementById('meta-value-date').setAttribute('disabled','true');
            }
        }
        function wrapDeep(con){
            Array.from(con.children).forEach(c=>{
                if(c.classList.contains('highlight')){const i=c.querySelector('div:not(.wrapper-toolbar)');if(i)wrapDeep(i);}
                if(c.classList.contains('edit-wrapper')||c.tagName==='BR'||c.tagName==='SUMMARY')return;
                if(con.tagName==='OL'||con.tagName==='UL'){const w=createWrapper(c.innerHTML);c.innerHTML='';c.appendChild(w);}
                else{const w=createWrapper(c.cloneNode(true));con.replaceChild(w,c);}
            });
        }
        function createWrapper(inner){
            const w=document.createElement('div');w.className='edit-wrapper';
            const ctr=document.createElement('div');ctr.className='wrapper-toolbar';ctr.contentEditable="false";
            ctr.innerHTML=`<div class="w-btn" onclick="moveBlock(this,-1)">â–²</div><div class="w-btn" onclick="moveBlock(this,1)">â–¼</div><div class="w-btn term" onmousedown="event.preventDefault();termFromRow(this)"><i class="fas fa-book"></i></div><div class="w-btn del" onclick="deleteBlock(this)">âœ–</div>`;
            const d=document.createElement('div');d.className='editable-content';d.setAttribute('contenteditable','true');d.addEventListener('input',markDirty);
            if(typeof inner==='string')d.innerHTML=inner;else d.appendChild(inner);
            w.appendChild(ctr);w.appendChild(d);return w;
        }
        window.moveBlock=function(b,d){let k=b.closest('.edit-wrapper');if(k.parentElement.tagName==='LI')k=k.parentElement;markDirty();if(d===-1&&k.previousElementSibling)k.parentNode.insertBefore(k,k.previousElementSibling);if(d===1&&k.nextElementSibling)k.parentNode.insertBefore(k.nextElementSibling,k);};
        window.deleteBlock=function(b){if(confirm('×œ××—×•×§?')){markDirty();let k=b.closest('.edit-wrapper');if(k.parentElement.tagName==='LI')k.parentElement.remove();else k.remove();}};
        window.termFromRow=function(b){b.closest('.edit-wrapper').querySelector('.editable-content').focus();window.createTerm();};
        document.getElementById('theme-toggle').addEventListener('click', ()=>document.body.classList.toggle('dark-mode'));
        function downloadSource(){if(isEditMode)toggleEditMode();isDirty=false;const blob=new Blob([document.documentElement.outerHTML],{type:'text/html'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=(document.title||'lesson')+'.html';a.click();}

        if(document.readyState==='loading') document.addEventListener('DOMContentLoaded', window.initMetaData); else window.initMetaData();
    </script>

</body></html>